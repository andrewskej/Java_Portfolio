<html>
<head>
<title>Online store</title>
<meta charset="UTF-8">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){

	$("#login-btn").click(function(){
	    $.ajax({
		   url:"LoginCheck.do",
	       data: {"mid": $("#mid").val(),"pwd": $("#pwd").val()},
	       type:"POST",
	       dataType:"text",
	       error:function(jqXHR){
	          alert(jqXHR.status);
	          alert(jqXHR.statusText);
	       },
	       success:function(responseData){
	    	   alert(responseData);
	           if(responseData=="Welcome!"){
	                var f = document.querySelector("#loginform");
	                   f.method="post";
	                   f.submit();
	             }
	       	  }
	      });
	   });

	$("#cartbuy").click(function(){  //to check if user clicked any checkbox in cart to proceed
			var cartcheck = $("input:checkbox[name='cartItems']").is(":checked");
			if (cartcheck == false){
				alert("Please choose at least one item to proceed")
				return false;
			}
	});


});
</script>

<style>
.navbar {
	margin-bottom: 50px;
	border-radius: 0;
}

.jumbotron {
	margin-bottom: 0;
}

footer {
	background-color: #f2f2f2;
	padding: 25px;
}

.modal {
        text-align: center;
}
@media screen and (min-width: 500px) {
 .modal:before {
                display: inline-block;
                vertical-align: middle;
                content: " ";
                height: 100%;
        }
}
.modal-dialog {
        display: inline-block;
        text-align: left;
        vertical-align: middle;
}

.div1 {
	text-align: right;
}

h3 {
	text-align: center;
}

#img {
	width: "1200px";
	height: "400px";
}

.img11{
      width:350px;
      height:300px;
}

.borderdiv img{
       border:1px dashed gray;
}


</style>
</head>
<body>
<div class="container">

	<% if(user){ %>
		<h3>welcome <b> <%=user.username%> </b>!</h3>
		<h3> <b>Level: <%=user.level%> </b></h3>
	<% }%>

	<% if(!user){ %>
		<h3>welcome <b> guest </b>!</h3>
		<h3>Logging in allows you to use cart</h3>
	<% }%>

   <h1><span class="glyphicon glyphicon-shopping-cart"></span> Online Store </h1><br>

	 <nav class="navbar navbar-inverse">
       <div class="collapse navbar-collapse" id="myNavbar">
         <ul class="nav navbar-nav">
           <li><a href="../../work" class="glyphicon glyphicon-home"></a></li>
           <li class="active"><a href="#">Mall Main</a></li>
           <li><a href="../../work/mall/products">All products</a></li>
           <!-- <li><a href="../mall/giftGuide">Gift Guide</a></li> -->
         </ul>
			   <ul class="nav navbar-nav navbar-right">
						<%if(user && user.level != 'admin'){%>
		    	     	<li><a href="myShopping.do?mid=${mid }"><span class="glyphicon glyphicon-user"></span><%=(user.username) %></a></li>
								<li><a data-target="#modal1" data-toggle="modal"><span class="glyphicon glyphicon-shopping-cart">Cart</span></a></li>
						<%}%>
			  		<%if(user && user.level == 'admin') {%>
								<li><a href="#"><span class="glyphicon glyphicon-user"></span><%=(user.username) %></a></li>
								<li><a href="../../work/mall/mallAdmin"><span class="glyphicon glyphicon-warning-sign"></span>Admin Mode</a></li>
						<%}%>
			   </ul>
  	  </div>
   </nav>

	<!--   Cart -->
    <div id="modal1" class="modal">
       <div class="modal-dialog lg">
          <div class="modal-content">
             <div class="modal-header">
                <button class="close" data-dismiss="modal">x</button>
                <h4>My Cart: <%=user.username%></h4>
             </div>

          <form action="cartPurchase" method="get">
             <div class="modal-body">
							 	<% if(!myCart){ %>
			            	<h3>Your cart is Empty!</h3>
								<% } %>
								<%if(myCart){%>
									<% for(var i=0;i<myCart.length;i++){ %>
											<div class="row" style="float:left; width:33%; margin:auto;">
									       <input type="checkbox" id="<%=myCart[i].ITEMNO%>" name="cartItems" value="<%=myCart[i].ITEMNO%>">
		              	     <label for="<%=myCart[i].ITEMNO%>">itemNo: <%=myCart[i].ITEMNO%></label>
		                   	 <p>itemName: <%=myCart[i].ITEMNAME%></p>
		                   	 <p>Price($): <%=myCart[i].PRICE%></p>
		                     <p name="quantity" value="quantity">Quantity: <%=myCart[i].QUANTITY%></p><span></span>
		                   	 <a class="btn btn-danger" href="delCart.do?itemNo=${c.itemNo}">remove</a>
					         			 <p>----------------------------------------</p>
	               	 		</div>
										<% } %>
									<% } %>
             <div class="modal-footer">
							 <%if(myCart){%>
								 <p> <%=myCart.length %> Item(s)</p>
             			<input type="submit" class="btn btn-success" id="cartbuy" value="checkout">
								<%}%>
             </div>
					 </div>
          </form>
        </div>
      </div>
   </div>
	<!-- cart ends -->


   	<!-- Carousel -->
   	<h2><b>Hot Deals</b></h2>
     <div class="carousel slide" id="mycarousel" data-ride="carousel">
			<ol class="carousel-indicators">
				<li class="active" data-target="#myCarousel" data-slide-to="0"></li>
				<li data-target="#myCarousel" data-slide-to="1"></li>
				<li data-target="#myCarousel" data-slide-to="2"></li>
			</ol>
			<div class="carousel-inner" id="img">
				<div class="item active">
						<a href="../../work/mall/products"><img alt="" src="uploads\Banner1.jpg" width="1200" height="150"></a>
				</div>
				<div class="item">
						<a href="../../work/mall/products"><img alt="" src="../uploads/Banner2.jpg" width="1200" height="150"></a>
				</div>
				<div class="item">
						<a href="../../work/mall/products"><img alt="" src="" width="1200" height="150"></a>
				</div>
			</div>
			<a class="left carousel-control" href="#mycarousel" data-slide="prev">
				<span class="glyphicon glyphicon-chevron-left"></span>
			</a>
			<a class="right carousel-control" href="#mycarousel" data-slide="next">
				<span class="glyphicon glyphicon-chevron-right"></span>
			</a>
		</div>
	<!-- Carousel Ends -->

	    <br><br>
	    <h2><b>New Arrivals</b></h2><br>
	      <div class="row text-center">
	         <c:forEach var="m" items="${mainList}">
		        <div class="col-sm-4">
		          <div class="borderdiv">
		           <a href="itemDetail/itemNo=${m.itemNo}"><img src="upload/${m.itemImg}" class="img11" alt=""></a>
		           <p><a href="itemDetail/itemNo=${m.itemNo}"><strong> ${m.itemName}</strong></a></p>
		           <p>No: ${m.itemNo}</p><p>$: ${m.itemPrice}</p>
		               <c:if test="${myLevel=='Red' }">
		                  <a href="itemDel.do?itemNo=${m.itemNo}"><button class="btn btn-danger">x</button></a>
		               </c:if>
		           </div>
		        </div>
	         </c:forEach>
	   	  </div>
      <br><br>



</div>
</body>
</html>
